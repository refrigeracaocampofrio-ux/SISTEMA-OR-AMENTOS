<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agendamento – Escolha a Data</title>
  <script src="js/notifier.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/header-styles.css">
  <link rel="stylesheet" href="css/system-text-colors.css">
  <style>
    :root { --primary:#3498db; --accent:#2ecc71; --dark-bg:#0f0f1e; --dark-card:#16213e; --dark-sidebar:#1a1a2e; }
    body { background: linear-gradient(135deg, #0f0f1e 0%, #1a1a2e 100%); color:#e0e0e0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; min-height:100vh; }
    .navbar-top{background:#1a1a2e; padding:12px 18px; border-bottom:1px solid rgba(52,152,219,0.3); display:flex; align-items:center; }
    .navbar-top img{ height:40px; margin-right:12px; }
    
    .container-box{ max-width:900px; margin:40px auto; background:var(--dark-card); border:1px solid rgba(52,152,219,0.3); border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,0.4); }
    .box-header{ padding:28px 32px; border-bottom:1px solid rgba(52,152,219,0.2); }
    .box-header h4{ font-size:28px; font-weight:700; color:#fff; letter-spacing:-0.5px; }
    .box-body{ padding:32px; }
    
    .alert-info-custom{ background:linear-gradient(135deg, rgba(46,204,113,0.1) 0%, rgba(52,152,219,0.1) 100%); border-left:4px solid #2ecc71; border-radius:8px; padding:16px 20px; margin-bottom:24px; color:#b0e0c9; font-size:14px; }
    .alert-info-custom strong{ color:#2ecc71; }
    
    .month-selector{ display:flex; justify-content:space-between; align-items:center; margin-bottom:28px; padding:16px 0; border-bottom:1px solid rgba(52,152,219,0.15); }
    .month-selector button{ background:var(--primary); border:none; color:#fff; padding:10px 18px; border-radius:6px; font-weight:600; font-size:14px; transition:all 0.3s ease; cursor:pointer; }
    .month-selector button:hover{ background:#2980b9; transform:translateY(-2px); box-shadow:0 4px 12px rgba(52,152,219,0.3); }
    .month-selector h5{ font-size:20px; font-weight:700; color:#fff; m:0; }
    
    .calendar{ display:grid; grid-template-columns:repeat(7,1fr); gap:10px; }
    .calendar .head{ text-align:center; color:#3498db; font-weight:700; padding:12px 0; font-size:12px; text-transform:uppercase; letter-spacing:1px; }
    .day{ aspect-ratio:1; display:flex; align-items:center; justify-content:center; border:2px solid rgba(52,152,219,0.2); border-radius:8px; cursor:pointer; background:linear-gradient(135deg, rgba(52,152,219,0.05) 0%, rgba(52,152,219,0.02) 100%); color:#b0b0c0; font-weight:600; font-size:14px; transition:all 0.2s ease; }
    .day:hover:not(.past):not(.disabled){ border-color:var(--primary); background:linear-gradient(135deg, rgba(52,152,219,0.15) 0%, rgba(52,152,219,0.08) 100%); color:#e0e0e0; }
    .day.selected{ background:linear-gradient(135deg, var(--primary) 0%, #2980b9 100%); color:#fff; border-color:var(--primary); box-shadow:0 4px 12px rgba(52,152,219,0.4); }
    .day.past{ opacity:.25; cursor:not-allowed; }
    .day.disabled{ opacity:.25; cursor:not-allowed; position:relative; }
    .day.disabled::after{ content:''; position:absolute; width:60%; height:2px; background:#e74c3c; transform:rotate(-45deg); }
    
    .actions{ display:flex; justify-content:flex-end; gap:12px; margin-top:28px; padding-top:16px; border-top:1px solid rgba(52,152,219,0.15); }
    .btn-custom{ padding:11px 24px; border-radius:6px; font-weight:600; font-size:14px; border:none; cursor:pointer; transition:all 0.3s ease; }
    .btn-custom-secondary{ background:transparent; color:#9aa4b3; border:1px solid #9aa4b3; }
    .btn-custom-secondary:hover{ background:rgba(52,152,219,0.1); color:#e0e0e0; border-color:var(--primary); }
    .btn-custom-primary{ background:var(--primary); color:#fff; }
    .btn-custom-primary:hover:not(:disabled){ background:#2980b9; transform:translateY(-2px); box-shadow:0 4px 12px rgba(52,152,219,0.3); }
    .btn-custom-primary:disabled{ opacity:.5; cursor:not-allowed; }
  </style>
</head>
<body>
  <nav class="navbar navbar-dark py-2 px-3 border-bottom" style="background: var(--dark-sidebar); border-bottom: 1px solid rgba(52, 152, 219, 0.3) !important;">
    <div class="container-fluid d-flex justify-content-center">
      <div class="d-flex align-items-center" style="gap: 14px; text-align: center; justify-content: center;">
        <img src="/imagens/logo-rcf.png" alt="RCF Logo" style="height: 60px; object-fit: contain;" onerror="this.onerror=null; this.src='/imagens/logo-rcf.svg';">
        <div style="line-height: 1.2;">
          <span class="navbar-brand mb-0 h1 fw-bold" style="color: #ffffff; margin: 0; font-size: 26px;">Refrigeração Campo Frio</span>
          <div class="navbar-text text-uppercase" style="font-size: 15px; letter-spacing: 0.8px; color: #ffffff; margin-top: 2px;">
            SISTEMA DE AGENDAMENTO DA REFRIGERAÇÃO CAMPO FRIO
          </div>
          <span class="navbar-text d-none d-sm-block" style="font-size: 12px; color: #ffffff !important;">Created by Marciel</span>
        </div>
      </div>
    </div>
  </nav>
  <div class="container-box">
    <div class="box-header"><h4 class="m-0">Bem-vindo ao sistema de agendamento de visitas da Refrigeração Campo Frio.</h4></div>
    <div class="box-body">
      <div class="alert alert-primary" style="background: rgba(52,152,219,0.12); border-color: rgba(52,152,219,0.35); color: #d8e9ff;">
        <strong>Escolha uma data disponível.</strong>
      </div>
      <div class="alert-info-custom"><strong>ℹ️ Informação:</strong> Domingos não atendemos.</div>
      <div class="month-selector">
        <button id="btnPrev">Anterior</button>
        <h5 id="mesAno" class="m-0"></h5>
        <button id="btnNext">Próximo</button>
      </div>
      <div id="calendar" class="calendar"></div>
      <div class="actions">
        <button class="btn-custom btn-custom-secondary" onclick="window.location.href='/index.html'">Cancelar</button>
        <button id="btnContinuar" class="btn-custom btn-custom-primary" disabled>Continuar</button>
      </div>
    </div>
  </div>
  <script>
    const meses = ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
    let mesAtual = new Date();
    mesAtual.setDate(1);
    let dataSelecionada = null;

    function formatISO(d){ return d.toISOString().split('T')[0]; }
    function saveDraft(part){ const k='agendamentoDraft'; const cur = JSON.parse(localStorage.getItem(k) || '{}'); localStorage.setItem(k, JSON.stringify(Object.assign(cur, part))); }

    function render(){
      const cal = document.getElementById('calendar'); cal.innerHTML='';
      document.getElementById('mesAno').textContent = `${meses[mesAtual.getMonth()]} ${mesAtual.getFullYear()}`;
      ['Dom','Seg','Ter','Qua','Qui','Sex','Sáb'].forEach(t=>{ const h=document.createElement('div'); h.className='head'; h.textContent=t; cal.appendChild(h); });
      const primeiro = new Date(mesAtual.getFullYear(), mesAtual.getMonth(), 1);
      const ultimo = new Date(mesAtual.getFullYear(), mesAtual.getMonth()+1, 0);
      for(let i=0;i<primeiro.getDay();i++){ cal.appendChild(document.createElement('div')); }
      const hoje = new Date(); hoje.setHours(0,0,0,0);
      for(let d=1; d<=ultimo.getDate(); d++){
        const cell = document.createElement('div'); cell.className='day'; cell.textContent=d;
        const dataCell = new Date(mesAtual.getFullYear(), mesAtual.getMonth(), d);
        const domingo = dataCell.getDay() === 0;
        if(dataCell < hoje){ cell.classList.add('past'); }
        else if(domingo){ cell.classList.add('disabled'); cell.title='Não atendemos aos domingos'; }
        else{
          cell.addEventListener('click', ()=>{ document.querySelectorAll('.day.selected').forEach(el=>el.classList.remove('selected')); cell.classList.add('selected'); dataSelecionada = dataCell; document.getElementById('btnContinuar').disabled=false; });
        }
        cal.appendChild(cell);
      }
    }

    document.getElementById('btnPrev').onclick = ()=>{ mesAtual = new Date(mesAtual.getFullYear(), mesAtual.getMonth()-1, 1); render(); };
    document.getElementById('btnNext').onclick = ()=>{ mesAtual = new Date(mesAtual.getFullYear(), mesAtual.getMonth()+1, 1); render(); };
    document.getElementById('btnContinuar').onclick = ()=>{ if(!dataSelecionada) return; saveDraft({ data_agendamento: formatISO(dataSelecionada) }); window.location.href = '/agendamento-horario.html'; };

    // init
    render();
  </script>
</body>
</html>
